# 统计学入门-14 方差分析
## 方差分析概念
方差分析就是通过检验各总体的均值是否相等来判断分类型自变量对数值型因变量是否有显著影响。
因素（因子）：在方差分析中，所要检验的对象
水平（处理）：在方差分析中，因素的不同表现
观测值：在每个因子水平下得到的样本数据
## 方差分析的基本假定
1、每个总体都应该服从正态分布。
2、各个个体的方差必须相同。
3、观测值是独立的。

## 单因素方差分析
概念：一个分类型自变量对一个数值型因变量的影响的分析研究
### 分析步骤
1、提出假设
H0:u1=u2=u3=...=uk   自变量对因变量没有显著影响
H1:u1!=u2!=u3!=...!=uk  自变量对因变量有显著影响
2、构造检验的统计量
（1）计算各样本的均值
（2）计算全部观测值的总平均值
（3）计算各误差平方和：总平方和SST、组间平方和SSA、组内平方和SSE
（4）计算统计量：F=MSA/MSE
MSA=SSA/k-1,MSE=SSE/n-k
3、作出统计决策
若F>Fa,则拒绝原假设H0
若F<Fa,则不拒绝原假设H0
4、方差分析表展示
### 关系强度
R2=SSA/SST

## 双因素方差分析
概念:两个分类型自变量对一个数值型因变量的影响的分析研究
### 无相互作用的双因素方差分析步骤
1、提出假设
H0:u1=u2=u3=...=uk   自变量对因变量没有显著影响
H1:u1!=u2!=u3!=...!=uk  自变量对因变量有显著影响
2、构造检验的统计量R
（1）计算各样本的均值
（2）计算全部观测值的总平均值
（3）计算各误差平方和：总平方和SST、行因素误差平方和SSR、列因素误差平方和SSC、随机误差平方和SSE
SST=SSR+SSC+SSE
（4）计算统计量：Fr=MSR/MSE,Fc=MSC/MSE
MSR=SSR/k-1,MSC=SSC/r-1,MSE=SSE/(k-1)(r-1)
3、作出统计决策
若Fr>Fa,则拒绝原假设H0
若Fc>Fa,则拒绝原假设H0
4、方差分析表展示
5、关系强度
R2=SSR+SSC/SST
### 有相互作用的双因素方差分析步骤
1、提出假设
H0:u1=u2=u3=...=uk   自变量对因变量没有显著影响
H1:u1!=u2!=u3!=...!=uk  自变量对因变量有显著影响
2、构造检验的统计量R
（1）计算各样本的均值
（2）计算全部观测值的总平均值
（3）计算各误差平方和：总平方和SST、行因素误差平方和SSR、列因素误差平方和SSC、交互作用平方和SSRC、随机误差平方和SSE
SST=SSR+SSC+SSRC+SSE
（4）计算统计量：Fr=MSR/MSE,Fc=MSC/MSE
MSR=SSR/k-1,MSC=SSC/r-1,MSE=SSE/(k-1)(r-1)
3、作出统计决策
若Fr>Fa,则拒绝原假设H0
若Fc>Fa,则拒绝原假设H0
4、方差分析表展示
5、关系强度
R2=SSR+SSC/SST
